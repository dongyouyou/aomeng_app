<!-- åˆ é™¤æµ®åŠ¨è£…é¥°å…ƒç´  -->

<!-- æ·»åŠ æµ®åŠ¨è£…é¥°å…ƒç´  -->
<view class="floating-element element-1"></view>
<view class="floating-element element-2"></view>
<view class="floating-element element-3"></view>

<view class="mine-container">
  <!-- å¤´éƒ¨èƒŒæ™¯ -->
  <view class="header-bg"></view>
  
  <!-- ç”¨æˆ·ä¿¡æ¯éƒ¨åˆ† -->
  <view class="user-info-section">
    <view class="user-card">
      <!-- æœªç™»å½•çŠ¶æ€ -->
      <block wx:if="{{!isLogged}}">
        <view class="not-login">
          <view class="login-content">
            <view class="login-header">
              <text class="login-title">æ‚¨å°šæœªç™»å½•</text>
              <text class="login-subtitle">ç™»å½•åå¯ä»¥äº«å—æ›´å¤šåŠŸèƒ½</text>
            </view>
            <button class="login-btn" bindtap="showLoginModal">å»ç™»å½•</button>
          </view>
        </view>
      </block>
      
      <!-- å·²ç™»å½•çŠ¶æ€ -->
      <block wx:else>
        <view class="logged-in">
          <view class="avatar-container">
            <view class="user-avatar {{isMember ? 'member-avatar' : ''}}">
              <text class="avatar-text">{{userInfo.nickname ? userInfo.nickname.substring(0,1) : (userInfo.nickName ? userInfo.nickName.substring(0,1) : 'å¥¥')}}</text>
              <view wx:if="{{isMember}}" class="crown-icon">ğŸ‘‘</view>
            </view>
          </view>
          <view class="user-info">
            <view class="user-name-container">
              <text class="user-name">{{userInfo.nickname || userInfo.nickName || 'å¥¥ç‰¹æ›¼è¿·'}}</text>
              <view class="user-status" wx:if="{{isMember}}">
                <text class="member-tag">ä¼šå‘˜</text>
                <text class="expire-date">æœ‰æ•ˆæœŸè‡³: {{formattedExpireDate}}</text>
              </view>
            </view>
            <button class="update-profile-btn" bindtap="updateUserProfile">
              <text class="btn-icon">â†»</text>æ›´æ–°èµ„æ–™
            </button>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- åŠŸèƒ½å¡ç‰‡åŒºåŸŸ -->
  <view class="cards-section">
    <!-- VIPä¼šå‘˜ä¸“åŒº -->
    <view class="card vip-card" bindtap="viewMembership">
      <view class="card-content">
        <view class="card-left">
          <view class="card-title">
            <text class="vip-badge">VIP</text>
            <text class="title-text">ä¼šå‘˜ä¸“åŒº</text>
          </view>
          <view class="card-desc">
            <text>{{isMember ? 'æ‚¨å·²å¼€é€šä¼šå‘˜ï¼Œæœ‰æ•ˆæœŸè‡³: ' + formattedExpireDate : 'æ¯æ—¥èµ é€æ¸¸æˆæ—¶é•¿'}}</text>
          </view>
        </view>
        <view class="card-right">
          <button class="action-button vip-button">{{isMember ? 'ç»­è´¹' : 'ç«‹å³å¼€é€š'}}</button>
        </view>
      </view>
    </view>

    <!-- æˆ‘çš„èµ„äº§ -->
    <view class="card asset-card" bindtap="viewAssets">
      <view class="card-content">
        <view class="card-left">
          <view class="card-title">
            <text class="title-text">æˆ‘çš„èµ„äº§</text>
          </view>
          <view class="card-desc asset-value">
            <text class="value-number">0</text><text class="value-unit">å°æ—¶</text>
            <text class="value-number">0</text><text class="value-unit">åˆ†</text>
          </view>
        </view>
        <view class="card-right">
          <view class="card-arrow"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½åˆ—è¡¨åŒºåŸŸ -->
  <view class="features-section">
    <!-- åŠŸèƒ½ç»„ -->
    <view class="feature-group">
      <view class="feature-item" bindtap="viewFavorites">
        <view class="feature-icon favorite-icon">
          <text class="icon-text">â˜…</text>
        </view>
        <text class="feature-title">æˆ‘çš„æ”¶è—</text>
        <view class="feature-arrow"></view>
      </view>

      <view class="feature-item" bindtap="contactService">
        <view class="feature-icon service-icon">
          <text class="icon-text">â˜</text>
        </view>
        <text class="feature-title">è”ç³»å®¢æœ</text>
        <view class="feature-arrow"></view>
      </view>

      <view class="feature-item" bindtap="aboutUs">
        <view class="feature-icon about-icon">
          <text class="icon-text">â„¹</text>
        </view>
        <text class="feature-title">å…³äºæˆ‘ä»¬</text>
        <view class="feature-arrow"></view>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
  <view class="logout-section" wx:if="{{isLogged}}">
    <button class="logout-btn" bindtap="logout">é€€å‡ºç™»å½•</button>
  </view>

  <!-- ç™»å½•æ¨¡æ€æ¡† -->
  <view class="login-modal {{showLogin ? 'show' : ''}}" catchtap="hideLoginModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ç™»å½•</text>
        <view class="close-btn" catchtap="hideLoginModal">Ã—</view>
      </view>
      <view class="modal-body">
        <view class="login-icon">
          <text class="login-icon-text">å¥¥</text>
        </view>
        <text class="login-desc">ä½¿ç”¨å¾®ä¿¡å¿«é€Ÿç™»å½•å¥¥ç‰¹æ›¼å›¾é‰´</text>
        <button class="phone-auth-btn" bindtap="wxLogin">
          å¾®ä¿¡ä¸€é”®ç™»å½•
        </button>
      </view>
    </view>
  </view>
</view>
